FROM node:23-alpine3.20

WORKDIR /app
ENV DATABASE_URL="file:./dev.db"
ENV JWT_SECRET="3d287d193ba2dd277b7d3c549e4ff5b3d3dae6c0b27219387872dba93a2761f4ffb976b5a87b97475dab3bb24609e8a932f8bca6bf9badd9131a377fcd8ce0f4cfda0d3338aa288ee2c347567e4bc2c2cda92a5e4120bb96af195bd7233d5df7016a0a8e8b5a8f73bb0a62b3a6742714e27909de0ecce565d353a3ae6aac1ea195fc20321afa3aff70150299eb5be379f751d48edf45c9ee676981a9a0f803ce59f267e4c1a66abfff8d168e0ca9665629ea08760d3eef89b19f8158aa445aa18b8623ab592cb5dc03f0a89ebe82b584c548e8bc66f90b6a643b5a47c777f7b5d819fa8bcdfb4e2f38dfcc822778d6988133672bd32e1c3b0604aba500c6e506"
COPY package*.json ./

RUN npm install

COPY . .

RUN npx prisma generate

RUN npx prisma migrate deploy

EXPOSE 4000

CMD [ "npm","run", "dev" ]